var nerdamer=function(){function Y(e,t){var n=t==="hash",r=t==="final";if(x(e)){var i="",p="",d="",v=e.group,m=e.value;if(!n){var g=e.multiplier;if(g===-1){d="-";g=1}if(g!==1)i=g;var y=e.power;if(y!==1){if(x(y)){p=Y(y)}else{p=y}}}switch(v){case s:i="";m=e.multiplier===-1?1:e.multiplier;p="";break;case f:m=e.collectSymbols(Y).join("+").replace("+-","-");break;case c:m=e.collectSymbols(Y).join("+").replace("+-","-");break;case l:m=e.collectSymbols(function(e){var t=e.group;if((t===f||t===c)&&e.power===1&&e.multiplier===1){return O(Y(e))}return Y(e)}).join("*");break;case u:var b=e.previousGroup,w=e.power.group;if(b===f)m=e.collectSymbols(Y).join("+").replace("+-","-");if(!(b===s||b===o||b===a)){m=O(m)}if((w===c||w===l||w===f||e.power.multiplier!==1)&&p){p=O(p)}break}if((v===c||v===f)&&i&&i!==1||(v===l||v===c||v===f)&&p&&p!==1||e.baseName===h){m=O(m)}if(p<0)p=O(p);if(i)i=i+"*";if(p)p="^"+p;return d+i+m+p}else{return e}}function Z(e){this.c=[];this.add=function(t){var n=e?e(t):true;if(this.c.indexOf(t)===-1&&n)this.c.push(t)}}function et(e){this.name=e}function tt(e){this.symbol=e}function nt(e){if(!(this instanceof nt)){return new nt(e)}if(!isNaN(e)){this.group=s;this.value="#";this.multiplier=Number(e)}else{if(e==="i"){this.isImgSymbol=true}this.group=o;E(e);this.value=e;this.multiplier=1;this.power=1}return this}function rt(e,t,n,r,i,s){this.val=e;this.fn=t;this.precedence=n;this.left_assoc=r;this.is_prefix=i;this.is_postfix=s||false}function it(e){this.val=e}function st(){function A(t){if(i.PARSE2NUMBER){return t}return e.symfunction("parens",[t])}function O(t){if(t.multiplier<0)t.multiplier*=-1;if(N(t)||U(t.power)){return t}return e.symfunction(v,[t])}function _(t){return e.pow(t,new nt("0.5"))}function P(t){var n;if(t.group===a&&t.baseName==="exp"){var r=t.args[0];if(t.multiplier===1)n=e.multiply(r,new nt(t.power));else n=e.symfunction("log",[t])}else if(i.PARSE2NUMBER&&N(t)){var s;if(t.multiplier<0){t.negate();s=e.multiply(new nt(Math.PI),new nt("i"))}n=new nt(Math.log(t.multiplier));if(s)n=e.add(n,s)}else{n=e.symfunction("log",arguments)}return n}function H(){return new at([].slice.call(arguments))}var e=this,t={},n=this.constants={PI:Math.PI,E:Math.E};var r={"^":new rt("^","pow",4,false,false),"*":new rt("*","multiply",3,true,false),"/":new rt("/","divide",3,true,false),"+":new rt("+","add",2,true,true),"-":new rt("-","subtract",2,true,true),",":new rt(",","comma",1,true,false)},d=this.functions={cos:[,1],sin:[,1],tan:[,1],sec:[,1],csc:[,1],cot:[,1],acos:[,1],asin:[,1],atan:[,1],exp:[,1],min:[,-1],max:[,-1],erf:[,1],floor:[,1],ceiling:[,1],fact:[,1],round:[,1],mod:[,2],vector:[H,-1],parens:[A,-1],sqrt:[_,1],log:[P,1],abs:[O,1]};var m={},y=function(e){return e[e.length-1]};var b="(",E=")",S="[",T="]",k=[];m[b]=b,m[E]=E,m[S]=S,m[T]=T;this.error=w;this.override=function(e,n){if(!t[e])t[e]=[];t[e].push(this[e]);this[e]=n};this.restore=function(e){if(this[e])this[e]=t[e].pop()};this.extend=function(e,t,n){var r=this,i=this[e];if(typeof i==="function"&&typeof t==="function"){var s=this[e];this[e]=function(e,i){if(x(e)&&x(i)&&!n)return s.call(r,e,i);else return t.call(r,e,i,s)}}};this.symfunction=function(e,t){var n=new nt(e);n.group=a;if(typeof t==="object")t=[].slice.call(t);n.args=t;n.baseName=e;n.updateHash();return n};this.callfunction=function(e,t){var n=d[e];if(!n)w(e+" is not a supported function.");var r=n[1],o=n[0],u;if(!(t instanceof Array))t=t!==undefined?[t]:[];if(r!==-1){var a=C(r),f=a?r[0]:r,l=a?r[1]:r,c=t.length;var h=e+" requires a {0} of {1} arguments. {2} provided!";if(c<f)w(D(h,"minimum",f,c));if(c>l)w(D(h,"maximum",l,c))}if(o){u=o.apply(n[2]||this,t)}else{if(i.PARSE2NUMBER){try{t=t.map(function(e){if(e.group===s)return e.multiplier;else w("Symbol must be of group N.")});var p=Math[e]?Math[e]:G[e];u=new nt(p.apply(undefined,t))}catch(v){u=this.symfunction(e,t)}}else{u=this.symfunction(e,t)}}return u};this.powerAdd=function(t,n,r){var i=!isNaN(n);if(!i||r||x(t.power)){var o=!x(n)?new nt(n):n;t.power=e.add(t.power,o)}else{t.power+=n}if(t.power.valueOf()===0)t.convert(s)};this.parse=function(t,i){t=t.split(" ").join("").replace(/\d*\.*\d+e[\+\-]*\d+/gi,function(e,t,n){if(/[a-z_]/.test(n.charAt(t-1)))return e;k.push(e);return"&"}).replace(/([\+\-\/\*]*[0-9]+)([a-z_]+[\+\-\/\*]*)/gi,function(){var e=arguments[4],t=arguments[1],n=arguments[2],r=arguments[3],i=e.charAt(r),s="",o="*";if(!i.match(/[\+\-\/\*]/))s=e.charAt(r-1);if(s.match(/[a-z]/i))o="";return t+o+n}).replace(/\)\(/g,")*(");var s=i||{},o=[],u=[],a=t.length,f=0,l,c,h,d=false,v=false,x=0,N=function(t){if(!t){t=o.pop()}var n=u.pop(),r=u.pop();if(!t&&!r&&n){C(n)}else if(t===b){if(d)w("Unmatched open parenthesis!");o.push(t);C(r);C(n)}else{var i=t.fn,s;if(!i)s=t.resolve(n);else s=e[i].call(e,r,n);C(s)}},C=function(e){if(/&/.test(e)){e=k.shift()}if(e!==""&&e!==undefined){if(!(e instanceof Array)){if(!(e instanceof nt)&&!M(e)){var n=s[e]||g[e];e=n?n.copy():new nt(e)}}while(y(o)instanceof it){if(v){var i=r[t.charAt(x+1)];if(i&&!i.left_assoc)break}if(O&&!O.left_assoc)break;var a=o.pop();e=a.resolve(e)}u.push(e);v=false}};if(!s["~"]){for(var L in n)s[L]=new nt(n[L])}for(x=0;x<a;x++){var A=t.charAt(x);var O=r[A],_=m[A];if(O||_){var D=t.substring(f,x);if(_===b&&D||_===S){var P=_===S?p:D;o.push(new et(P),b);f=x+1;l=x;continue}C(D);if(!_&&(x-l===1||x===0)){if(O.is_prefix){o.push(new it(O.val));f=x+1;l=x;continue}w(O.val+" is not a valid prefix operator!:"+f)}if(A!==E)l=x;if(O){if(c){if(O.left_assoc&&O.precedence<=c.precedence||!O.left_assoc&&O.precedence<c.precedence){var H=false;do{N();var B=y(o);if(B===b)break;H=B?B.left_assoc&&B.precedence<O.precedence:true}while(!H)}}o.push(O);c=y(o)}else{if(A===b){o.push(_)}else if(A===E||A===T){l=null;var j=false;while(!j){var F=o.pop();if(F===undefined)w("Unmatched close bracket or parenthesis!");if(F===b){j=true}else N(F);if(F===b&&A===T){var I=y(o);if(!I||I.name!==p)w("Unmatched parenthesis!")}}var q=y(o);if(q instanceof et){if(q.name===p&&A!==T)w("Unmatched bracket!");var R=e.callfunction(o.pop().name,u.pop());v=true;C(R)}}c=y(o)}f=x+1}else if(x===a-1){C(t.substring(f,x+1))}h=A}d=true;while(o.length>0){N()}return u[0]};this.ext={log:P,sqrt:_,abs:O,vector:H,parens:A};this.mapped_function=function(){var t={},n=this.params;for(var r=0;r<n.length;r++)t[n[r]]=arguments[r];return e.parse(this.body,t)};this.unpack=function(e){if(e.power===1){var t=e.args[0];t.multiplier*=e.multiplier;e=t}return e};this.add=function(e,t){var n=e.group,r=t.group;if(e.multiplier===0)return t;if(t.multiplier===0)return e;if(n===a&&e.baseName===h)e=this.unpack(e);if(r===a&&e.baseName===h)t=this.unpack(t);if(n>r){return this.add(t,e)}if(i.SAFE){e=e.copy();t=t.copy()}if(e.value===t.value&&!(n===c&&e.power!==t.power)){if(e.power===t.power&&r!==f||n===u&&e.equals(t)){e.multiplier+=t.multiplier;if(e.multiplier===0)e=nt(0)}else if(r===f){if(n===f){if(e.power===1&&t.power===1){e.distributeMultiplier();t.distributeMultiplier();for(var s in t.symbols){e.attach(t.symbols[s])}}else if(e.power===t.power){e.multiplier+=t.multiplier}else{if(e.power>t.power){var o=e;e=t;t=o}e.convert(c);e.attach(t)}}else{if(t.multiplier===1){t.attach(e)}else{for(var s in t.symbols){t.symbols[s].multiplier*=t.multiplier}t.multiplier=1;t.attach(e)}e=t}}else{e.convert(f);e.attach(t)}}else if(r===c){if(n===c){if(e.power>t.power){var o=e;e=t;t=o}if(e.value===t.value){e.convert(f);e.attach(t)}else if(e.power===1){if(t.power===1){var s;e.distributeMultiplier();t.distributeMultiplier();for(s in t.symbols){this.add(t.symbols[s],e)}}else{e.attach(t)}}else{var l=new nt("blank");l.symbols={};l.length=1;l.group=c;l.attach(e);l.attach(t);e=l}}else{if(t.power===1){if(t.multiplier===1){t.attach(e)}else{for(var s in t.symbols){t.symbols[s].multiplier*=t.multiplier}t.multiplier=1;t.attach(e)}e=t}else{e.convert(c);e.attach(t)}}}else{e.convert(c);e.attach(t)}if((e.group===c||e.group===f)&&e.length===1){for(var p in e.symbols){var d=e.symbols[p];d.multiplier*=e.multiplier;e=d}}return e};this.subtract=function(e,t){return this.add(e,t.negate())};this.multiply=function(t,n){if(t.multiplier===0||n.multiplier===0)return new nt(0);var r=t.group,p=n.group,d=false;if(r===a&&t.baseName===h)t=this.unpack(t);if(p===a&&t.baseName===h)n=this.unpack(n);if(t.isImgSymbol&&n.isImgSymbol){var v=t.power+n.power===0?1:-1;return new nt(v*t.multiplier*n.multiplier)}if(r>p)return this.multiply(n,t);if(i.SAFE){t=t.copy();n=n.copy()}if(L(t.power)&&L(n.power)){d=true;t.invert();n.invert()}if(r===s){n.multiplier*=t.multiplier}else if(t.value===n.value){if(r===o&&p===u){if(n.previousGroup===f){n.convert(l);n.combine(t)}else{n.power=e.add(n.power,nt(t.power))}}else if(r===u){if(p===f){n.convert(l);n.combine(t)}else{var m=t.previousGroup,g=n.previousGroup;if(m===o||m===s||m===a){var y=t.power,b=n.power;if(n.group!==u){b=new nt(b);n=t}n.power=e.add(y,b)}else if(m===f&&m===g){if(t.keyForGroup(l)!==n.keyForGroup(l)){n.convert(l);n.combine(t)}else{n.power=e.add(n.power,t.power)}}else if(p===u){n.power=e.add(t.power,n.power)}else{var w=new nt(n.power);t.power=e.add(t.power,w);n=t}}}else if(p===f){n.distributeMultiplier();if(r!==f){if(n.power===1){var E=n.copy();E.symbols={};E.length=0;for(var S in n.symbols){var x=V(n.symbols,S);var T=e.multiply(t,x);if(T.value!==E.value)E.group=c;E.attach(T)}n=E}else{n.convert(l);n.combine(t)}}else{if(t.value===n.value){n.power+=t.power}else{n.convert(l);n.combine(t)}}}else{n.power+=t.power}n.multiplier*=t.multiplier;if(Number(n.power)===0)n=nt(n.multiplier)}else if(r===l&&p===l){t.distributeExponent();n.distributeExponent();if(t.power===1&&n.power!==1){var N=t;t=n;n=N}if(t.power===1&&n.power===1){n.multiplier*=t.multiplier;for(var S in t.symbols){n.combine(t.symbols[S])}}else if(n.power===1){n.attach(t)}else{var S=new nt("x");S.symbols={};S.group=l;S.combine(t);S.combine(n);n=S}}else if(p===l){n.distributeExponent();n.combine(t)}else if(r===o&&p!==l){t.convert(l);t.combine(n);n=t}else{if(r===l){t.combine(n);n=t}else{n.convert(l);n.combine(t)}}if(n.group===l&&n.length===1){for(var C in n.symbols){var x=n.symbols[C];x.multiplier*=n.multiplier;n=x}}if(d)n.invert();return n};this.divide=function(e,t){if(t.multiplier===0)w("Division by zero!");return this.multiply(e,t.invert())};this.pow=function(t,n){var r=Number(n);if(r===1)return t;if(r===0)return new nt(1);var o=t.group,f=n.group;if(i.SAFE){t=t.copy();n=n.copy()}if(o!==u&&f===s){var c=n.multiplier;if(c!==1){if(c===0){n.mutiplier=1;t=n}else{var p=U(c),d=t.multiplier<0,m=U(t.power),g=Math.abs(c%1)>0;if(o===s){var y=d&&g;if(y)t.multiplier*=-1;t.multiplier=Math.pow(t.multiplier,c);if(y){t=this.multiply(t,new nt("i"));if(c<0)t.negate()}}else{var b=t.multiplier,w=Math.pow(Math.abs(b),c),E=Math.abs(b)/b;t.power*=c;t.multiplier=w;if(d&&!p)t.multiplier*=E;if(g&&d){var S=-t.multiplier;if(m){t.multiplier=1;if(!U(t.power)){t=this.symfunction(v,[t])}t=this.multiply(new nt("i"),t)}else{var T=t.power;t.multiplier/=S;t.power/=T;t=this.symfunction(h,[t]);t.power=T}t.multiplier=S}if(m&&g&&!U(t.power)){var T=t.power;t.power=1;t=e.symfunction(v,[t]);t.power=T}if(t.group===a&&t.baseName===v){var w=t.args[0];var N=t.power*w.power;if(U(N)){w.power=N;w.multiplier=t.multiplier*Math.pow(w.multiplier,t.power);t=w}}}}}if(o===l){var T=t.power;for(var C in t.symbols){t.symbols[C].power*=T}t.power=1}}else{var S,k=t.power;if(!x(k))k=new nt(k||1);if(Math.abs(t.multiplier)!==1){S=new nt(t.multiplier);S.convert(u);S.power=n.copy();t.multiplier=1}if(t.group!==u)t.convert(u);t.power=this.multiply(k,n);if(t.power.isOne()){t.group=t.previousGroup;delete t.previousGroup;t.power=1}if(S){t=this.multiply(t,S)}}return t};this.comma=function(e,t){if(e instanceof Array)e.push(t);else e=[e,t];return e}}function at(e){if(T(e))this.elements=e.items.slice(0);else this.elements=e||[]}var e="0.5.4",t=new st,n={},r={},i={suppress_errors:false,PARSE2NUMBER:false,SAFE:false},s=n.N=1,o=n.S=2,u=n.EX=3,a=n.FN=4,f=n.PL=5,l=n.CB=6,c=n.CP=7,h="parens",p="vector",d="sqrt",v="abs",m=[],g={},y=[],b=r.isReserved=function(e){return y.indexOf(e)!==-1},w=function(e){if(!i.suppress_errors)throw new Error(e)},E=r.validateName=function(e,t){t=t||"variable";var n=/^[a-z_][a-z\d\_]*$/gi;if(!n.test(e)){w(e+" is not a valid "+t+" name")}},S=r.isFraction=function(e){if(x(e))return S(e.multiplier);return e%1!==0},x=r.isSymbol=function(e){return e instanceof nt},T=r.isVector=function(e){return e instanceof at},N=r.isNumericSymbol=function(e){return e.group===s},C=r.isArray=function(e){return e instanceof Array},k=r.isInt=function(e){return e%1===0},L=r.isNegative=function(e){if(x(e)){e=e.multiplier}return e<0},A=r.isComposite=function(e){return e.group===f||e.group===c},O=r.inBrackets=function(e){return"("+e+")"},M=r.customType=function(e){return e!==undefined&&e.custom},_=r.sameSign=function(e,t){return e<0===t<0},D=r.format=function(){var e=[].slice.call(arguments),t=e.shift();return t.replace(/{(\d+)}/g,function(t,n){var r=e[n];return typeof r==="function"?r():r})},P=r.keys=function(e){var t=[];for(var n in e){t.push(n)}return t},H=r.firstObject=function(e){for(var t in e)break;return e[t]},B=r.arrayMax=function(e){return Math.max.apply(undefined,e)},j=r.arrayMin=function(e){return Math.min.apply(undefined,e)},F=r.round=function(e,t){t=t||14;return Math.round(e*Math.pow(10,t))/Math.pow(10,t)},I=r.insertArray=function(e,t,n,r){r=r===false?r:true;if(C(t)&&r){for(var i=0;i<=t.length+1;i++){I(e,t.pop(),n)}}else if(typeof n==="undefined "){e.push(t)}else{e.splice(n,0,t)}},q=r.variables=function(e,t){t=t||{c:[],add:function(e){if(this.c.indexOf(e)===-1&&isNaN(e))this.c.push(e)}};if(x(e)){var n=e.group,r=e.previousGroup;if(n===c||n===l||r===c||r===l){for(var i in e.symbols)q(e.symbols[i],t)}else if(n===o||n===f){t.add(e.value)}else if(n===u){if(!isNaN(e.value))t.add(e.value);q(e.power,t)}else if(n===a){for(var s=0;s<e.args.length;s++){q(e.args[s],t)}}}return t.c.sort()},R=r.each=function(e,t){if(C(e)){var n=e.length;for(var r=0;r<n;r++)t.call(e,r)}else{for(var i in e)if(e.hasOwnProperty(i))t.call(e,i)}},U=r.even=function(e){return e%2===0},z=r.evenFraction=function(e){return 1/(e%1)%2===0},W=r.arrayUnique=function(e){var t=e.length,n=[];for(var r=0;r<t;r++){item=e[r];if(n.indexOf(item)===-1)n.push(item)}return n},X=r.reserveNames=function(e){var t=function(e){if(y.indexOf(e)===-1)y.push(e)};if(typeof e==="string")t(e);else{R(e,function(e){t(e)})}},V=r.remove=function(e,t){var n;if(C(e)){n=e.splice(t,1)[0]}else{n=e[t];delete e[t]}return n},$=r.block=function(e,t,n,r){var s=i[e];i[e]=n===undefined?true:!!n;var o=t.call(r);i[e]=s;return o},J=r.arguments2Array=function(e){return[].slice.call(e)},K=function(e,t,n,r){r=r||0;var i=n.length,s=0,o;for(var u=r;u<i;u++){var a=n.charAt(u);if(a===e){if(o===undefined)o=u+1;s++}if(a===t){s--;if(s===0&&o!==undefined){var f=u;return[n.substring(o,f),o,f]}}}return[]},Q=function(e){for(var n in e)e[n]=t.parse(e[n].toString());return e},G={csc:function(e){return 1/Math.sin(e)},sec:function(e){return 1/Math.cos(e)},cot:function(e){return 1/Math.tan(e)},erf:function(e){var t=1,n=1,r=e*1;for(var i=1;i<50;i++){t*=i;n*=-1;r+=n*Math.pow(e,2*i+1)/(t*(2*i+1))}return 2*r/Math.sqrt(3.14159265358979)},fact:function(e){var t=1;for(var n=2;n<=e;n++)t=t*n;return t},mod:function(e,t){return e%t},GCD:function(){var e=[].slice.call(arguments).map(function(e){return Math.abs(e)}).sort(),t=Math.abs(e.shift()),n=e.length;while(n-->0){var r=Math.abs(e.shift());while(true){t%=r;if(t===0){t=r;break}r%=t;if(r===0)break;}}return t}};X(G);r.text=Y;tt.getExpression=function(e,t){if(e==="last"||!e)e=m.length;if(e==="first")e=1;var n=e-1,r=m[n],i=r?new tt(r):r;return i};tt.prototype={text:function(){return this.symbol.text("final")},latex:function(){return ut.latex(this.symbol)},valueOf:function(){return this.symbol.valueOf()},evaluate:function(){var e=arguments[0],n,r=1;if(typeof e==="string"){n=e.charAt(0)==="%"?tt.getExpression(e.substr(1)).text():e}else if(e instanceof tt||x(e)){n=e.text()}else{n=this.symbol.text();r--}var i=arguments[r];return new tt($("PARSE2NUMBER",function(){return t.parse(n,Q(i))},true))},buildFunction:function(e){return lt(this.symbol,e)},isNumber:function(){return N(this.symbol)},isInfinity:function(){return Math.abs(this.symbol.multiplier)===Infinity},variables:function(){return q(this.symbol)},toString:function(){return this.symbol.text()},isMonomial:function(){return this.symbol.group===o},isFraction:function(){return S(this.symbol)},isPolynomial:function(){return this.symbol.isPoly()}};nt.prototype={coeffs:function(){var e=[];if(this.symbols){for(var t in this.symbols){e.push(this.symbols[t].multiplier)}}else e.push(this.multiplier);return e},equals:function(e){return this.value===e.value&&Y(this.power)===Y(e.power)},isPoly:function(){var e=false;if(this.group===o&&this.power>0||this.group===s){e=true}else{var t=P(this.symbols).sort(),n=t.length;if(n===2&&t[0]==="#"){e=this.symbols[t[1]].isPoly()}else if(this.group===f){e=true;for(var r=0;r<n;r++){if(t[r]<0){e=false}}}}return e},isInverse:function(){if(this.group===u)return this.power.multiplier<0;return this.power<0},copy:function(){var e=new nt(0),t=["multiplier","value","group","length","previousGroup","isImgSymbol","baseName","args"],n=t.length,r;if(this.symbols){e.symbols={};for(var i in this.symbols){e.symbols[i]=this.symbols[i].copy()}}for(r=0;r<n;r++){if(this[t[r]]!==undefined){e[t[r]]=this[t[r]]}}if(this.power){e.power=x(this.power)?this.power.copy():this.power}return e},each:function(e){for(var t in this.symbols){e.call(this,this.symbols[t],t)}},valueOf:function(){if(this.group===s){return this.multiplier}else if(this.power===0){return 1}else if(this.multiplier===0){return 0}else{return Y(this)}},contains:function(e,t){var n=this.group;if(this.symbols){for(var r in this.symbols){if(this.symbols[r].contains(e,t))return true}}else if(n===a||this.previousGroup===a){for(var i=0;i<this.args.length;i++){if(this.args[i].contains(e,t))return true}}else if(n===u){if(t&&this.power.contains(e,t)){return true}return this.value===e}return this.value===e},negate:function(){this.multiplier*=-1;if(this.group===c||this.group===f)this.distributeMultiplier();return this},invert:function(e){if(!e)this.multiplier=1/this.multiplier;if(x(this.power)){this.power.negate()}else{if(this.power)this.power*=-1}return this},distributeMultiplier:function(){if(this.symbols&&this.power===1&&this.group!==l){for(var e in this.symbols){var t=this.symbols[e];t.multiplier*=this.multiplier;t.distributeMultiplier()}this.multiplier=1}return this},distributeExponent:function(){if(this.power!==1){var e=this.power;for(var n in this.symbols){var r=this.symbols[n];if(r.group===u){r.power=t.multiply(r.power,new nt(e))}else{this.symbols[n].power*=e}}this.power=1}return this},convert:function(e){if(e>a){var t=this.copy();this.symbols={};if(e===l){t.multiplier=1}else{this.multiplier=1}if(this.group===a){t.args=this.args;delete this.args;delete this.baseName}if(this.isImgSymbol)delete this.isImgSymbol;this.power=1;this.symbols[t.keyForGroup(e)]=t;this.group=e;this.length=1}else if(e===u){if(!(this.group===s&&Math.abs(this.multiplier)===1)){this.previousGroup=this.group;if(this.group===s){this.value=this.multiplier;this.multiplier=1}this.group=u}}else if(e===s){for(var n in this){if(this.hasOwnProperty(n)&&n!=="value"&&n!=="multiplier")delete this[n]}this.value="#";this.group=s}},insert:function(e,n){if(!x(e))w("Object "+e+" is not of type Symbol!");if(this.symbols){var r=this.group;if(r>a){var i=e.keyForGroup(r);var o=this.symbols[i];if(n==="add"){var u=i;if(o){this.symbols[u]=t.add(o,e);if(this.symbols[u].multiplier===0){delete this.symbols[u];this.length--;if(this.length===0){this.convert(s);this.multiplier=0}}}else{this.symbols[i]=e;this.length++}}else{if(o){e=t.multiply(V(this.symbols,i),e);if(this.length===0)this.convert(s);this.length--}this.multiplier*=e.multiplier;e.multiplier=1;if(Math.abs(e.valueOf())!==1){if(this.power!==1){var f=this.copy();f.multiplier=1;this.power=1;this.symbols={};var h=f.keyForGroup(l);this.symbols[h]=f}this.symbols[i]=e;this.length++}}if(this.group===c||this.group===l){this.updateHash()}}}},attach:function(e){this.insert(e,"add")},combine:function(e){this.insert(e,"multiply")},updateHash:function(){if(this.group===a){var e="",t=this.args,n=this.baseName===h;for(var r=0;r<t.length;r++)e+=(r===0?"":",")+Y(t[r]);var i=n?"":this.baseName;this.value=i+(n?e:O(e))}else if(!(this.group===o||this.group===f)){this.value=Y(this,"hash")}},keyForGroup:function(e){var t=this.group;if(t===s){return this.value}else if(t===o){if(e===f)return this.power;else return this.value}else if(t===a){if(e===f)return this.power;return Y(this,"hash")}else if(t===f){if(e===l)return Y(this,"hash");if(e===c){if(this.power===1)return this.value;else return O(Y(this,"hash"))+"^"+this.power}return this.value}else if(t===c){if(e===c)return Y(this,"hash");if(e===f)return this.power;return this.value}else if(t===l){if(e===f)return this.power;return Y(this,"hash")}else if(t===u){if(e===f)return Y(this.power);return Y(this,"hash")}},collectSymbols:function(e){var t=[];for(var n in this.symbols){var r=this.symbols[n];t.push(e?e(r):r)}return t.sort()},text:function(){return Y(this)},isOne:function(){if(this.group===s)return this.multiplier===1;else return this.power===0},getDenom:function(){if(this.group===l){for(var e in this.symbols){if(this.symbols[e].power<0)return this.symbols[e]}}},toString:function(){return this.text()}};rt.prototype={toString:function(){return this.val}};it.prototype={resolve:function(e){if(this.val==="-"){return e.negate()}return e}};var ot={convert:function(e,t){var n;if(e===0){n=[0,1]}else{if(e<1e-6||e>1e20){var r=this.quickConversion(Number(e));if(r[1]<=1e20){var i=Math.abs(e);var s=e/i;n=this.fullConversion(i.toFixed((r[1]+"").length-1));n[0]=n[0]*s}else{n=r}}else{n=this.fullConversion(e)}}return n},quickConversion:function(e){var t=(e.toExponential()+"").split("e");var n=t[0].split(".")[1];var r=n?n.length:0;return[Math.pow(10,r)*t[0],Math.pow(10,Math.abs(t[1])+r)]},fullConversion:function(e){var t=false;var n=0,r=1,i=1,s=0,o=0,u=e,a=1e-13;while(!t){o++;if(o>1e4){t=true}var f=parseInt(u);var l=n+f*i;var c=r+f*s;var h=u-f;if(h<a){t=true}u=1/h;n=i;r=s;i=l;s=c;if(Math.abs(l/c-e)<a||o>30){t=true}}return[l,c]}};var ut={space:"~",latex:function(e,t,n,r){t=t||false;n=n||e.group;var i="",p=this.inBraces,d;if(x(e)){switch(n){case s:d=e.multiplier;if(t)d=Math.abs(d);if(k(d)){i=d}else if(Math.abs(d)===Infinity){i="\\infty";if(d===-Infinity)i="-"+i}else{var v=ot.convert(d);i=this.fraction(v)}break;case o:i=this.renderSymbolLatex(e,undefined,t);break;case a:var m=e.baseName;if(m===h)m="";else if(m in Math||m in G)m="\\"+m;var g=e.args.slice(0).map(function(e){return ut.latex(e)});if(m==="\\abs"){d="\\left|"+g+"\\right|"}else{d=m+this.inBrackets(g)}i=this.renderSymbolLatex(e,d,t);break;case f:var d=this.renderSubSymbolsLatex(e,function(e,t){return e.power<t.power},undefined,t);i=this.renderSymbolLatex(e,d,t,e.group===u);break;case c:d=this.renderSubSymbolsLatex(e,function(e,t){return e.group<t.group},undefined,t);i=this.renderSymbolLatex(e,d,t,e.group===u);break;case l:d=this.renderSubSymbolsLatex(e,function(e,t){return e.group<t.group},true,t);i=this.renderSymbolLatex(e,d,t);break;case u:var y=e.previousGroup;if(y===s){y=o}i=this.latex(e,t,y);break}}else if(C(e)){var b=e.length;for(var w=0;w<b;w++){i="\\left["+e.map(function(e){return ut.latex(e)}).join(" ,")+"\\right]"}}else if(typeof e.latex==="function"){i=e.latex()}else{i=e}if(r)i=this.inBrackets(i);return i},renderSubSymbolsLatex:function(e,t,n,r){function v(t){var i,s=t.length,o="";for(var i=0;i<s;i++){var u=t[i],h;if(u.multiplier<0){h="-"}else if(n){h=""}else{h="+"}r=r||i>0;var p=a.latex(u,r,undefined,e.group===l&&(u.group===f||u.group===c));if(i>0)p=h+p;o+=p}return o}var i=e.collectSymbols().sort(t),s=i.length,o=[],u,a=this,h=e.group,p=Math.abs(e.power)===.5;for(u=0;u<s;u++){var d=i[u];if(d.isInverse()&&h===l){o.push(V(i,u).copy().invert());u--,s--}}if(t){i.sort(t);o.sort(t)}var m=v(i),o=v(o);if(h===c||h===f){if(m&&!o&&Math.abs(e.multiplier)!==1||Math.abs(e.power!==1)){if(!p)m=ut.inBrackets(m)}}if(o&&!m)m=1;if(o)return D("\\frac{{0}}{{1}}",m,o);else return m},renderSymbolLatex:function(e,t,n,r){if(e.group===s)return this.latex(e,n);t=t||e.value;var i=ot.convert(e.multiplier),o=e.power||"",u=e.multiplier<0?"-":"",a=o===.5,f=o===-.5;if(n)u="";i[0]=Math.abs(i[0]);if(x(o)){o=this.latex(o,true)}else{if(Math.abs(o)===1||a||f){o=""}else{var l=ot.convert(o);if(l[1]===1)l.pop();if(e.power<0){l[0]=Math.abs(l[0])}o=this.fraction(l)}}if(i[1]===1)i.pop();var c=L(e.power)?1:0;if(i[c]===1){i[c]=t}else{if(/^\\frac/.test(t)){var h=4;for(var p=0;p<2;p++){var d=i[p],v=!(d===1||d===undefined)?d+this.space:"";var m=K("{","}",t,h);i[p]=v+m[0];h=m[2]+1}}else{var g=i[c]?i[c]+this.space:"";if(f)t="\\sqrt"+this.inBraces(t);i[c]=g+t}}if(o){i[c]=this[r?"inBrackets":"inBraces"](i[c]);if(!a){i[c]+="^"+this.inBraces(o)}}t=this.fraction(i);var y=u+t;if(a)y="\\sqrt"+this.inBraces(y);return y},fraction:function(e){if(e.length===1)return e[0];return"\\frac"+this.inBraces(e[0])+this.inBraces(e[1])},inBraces:function(e,t){t=t===undefined?"":"$"+t;return"{"+e+t+"}"},inBrackets:function(e){return"\\left("+e+"\\right)"},write2Fraction:function(e,t,n){return e.replace("$1",t).replace("$2",n)}};at.prototype.custom=true;var ft=function(){X(t.constants);X(t.functions)};var lt=r.build=function(e,n){var r=q(e);var i=function(e,n){n=n||[];var r=[],f=e.group,c="";var h=function(t){var r=t===l?"*":"+",s=[];for(var o in e.symbols)s.push(i(e.symbols[o],n)[0]);var u=s.join(r);return u?O(u):u},p=function(r){var s;if(r in Math)s="Math."+r;else{n.push("var "+r+" = "+t.Math2[r].toString()+"; ");s=r}s=s+O(e.args.map(function(e){return i(e,n)[0]}).join(","));return s};if(f===s)r.push(e.multiplier);else if(e.multiplier===-1)c="-";else if(e.multiplier!==1)r.push(e.multiplier);var d=null;if(f===o)d=e.value;else if(f===a){d=p(e.baseName)}else if(f===u){var v=e.previousGroup;if(v===s||v===o)d=e.value;else if(v===a)d=p(e.baseName);else d=h(e.previousGroup)}else{d=h(e.group)}if(e.power!==undefined&&e.power!==1){d="Math.pow"+O(d+","+Y(e.power))}if(d)r.push(c+d);return[r.join("*"),n.join("").replace(/\n+\s+/g," ")]};if(n){if(r.length!==n.length)w("Argument array contains wrong number of arguments");for(var f=0;f<r.length;f++){var c=r[f];if(n.indexOf(c)===-1)w(c+" not found in argument array")}r=n}var h=i(e);return new Function(r,h[1]+" return "+h[0]+";")};ft();var ct={};ct.groups=n;ct.Symbol=nt;ct.Expression=tt;ct.Vector=at;ct.Parser=st;ct.Fraction=ot;ct.Math2=G;ct.Latex=ut;ct.Utils=r;ct.PARSER=t;ct.PARENTHESIS=h;ct.Settings=i;ct.VARS=g;var ht=function(e,n,r,s){if(e instanceof tt)e=e.toString();var o=C(r),u="expand",a=o?r.indexOf("numer")!==-1:r==="numer";if((o?r.indexOf(u)!==-1:r===u)&&typeof ct.Algebra.expand!=="undefined"){e=D("{0}({1})",u,e)}var f=$("PARSE2NUMBER",function(){return t.parse(e,Q(n))},a||i.PARSE2NUMBER);if(s){m[s-1]=f}else{m.push(f)}return new tt(f)};ht.version=function(){return e};ht.setConstant=function(e,n){E(e);if(!b(e)){if(n==="delete"){delete t.constants[e]}else{if(isNaN(n))w("Constant must be a number!");t.constants[e]=n}}return this};ht.setFunction=function(e,n,r){E(e);if(!b(e)){n=n||q(t.parse(r));t.functions[e]=[t.mapped_function,n.length,{name:e,params:n,body:r}];return true}return false};ht.getCore=function(){return ct};ht.getExpression=ht.getEquation=tt.getExpression;ht.reserved=function(e){if(e){return y}return y.join(", ")};ht.clear=function(e,t){if(e==="all"){m=[]}else if(e==="last"){m.pop()}else if(e==="first"){m.shift()}else{var n=!e?m.length:e-1;t===true?m[n]=undefined:V(m,n)}return this};ht.expressions=function(e,t){var n=e?{}:[];for(var r=0;r<m.length;r++){var i=t?ut.latex(m[r]):Y(m[r]);e?n[r+1]=i:n.push(i)}return n};ht.register=function(e){var n=this.getCore();if(C(e)){for(var r=0;r<e.length;r++){if(e)this.register(e[r])}}else if(e){var i=e.parent,s=e.build.call(n);if(i){if(!n[i])n[e.parent]={};n[i][e.name]=s}if(e.visible)t.functions[e.name]=[s,e.numargs]}};ht.validateName=E;ht.supported=function(){return P(t.functions)};ht.numEquations=ht.numExpressions=function(){return m.length};ht.setVar=function(e,n){E(e);if(n==="delete")delete g[e];else g[e]=t.parse(n);return this};ht.set=function(e,t){var n=["SAFE"];if(n.indexOf(e)!==-1)w("Cannot modify setting: "+e);i[e]=t};return ht}();(function(){var e=nerdamer.getCore(),t=e.PARSER,n=e.Utils.keys,r=e.Utils.text,s=e.Utils.remove,o=e.Symbol,u=e.groups.S,a=e.Utils.round,f=e.Utils.isInt,l=e.Math2,c=e.Utils.variables,h=e.Utils.isComposite,p=e.Utils.isSymbol,d=e.groups.PL,v=e.groups.CP;var m=e.Algebra={proots:function(t,r){function p(){function b(e,t,n,r,i,s){i[0]=s.b=r[0];i[1]=s.a=-(t*s.b)+r[1];for(var o=2;o<e;o++){i[o]=-(t*s.a+n*s.b)+r[o];s.b=s.a;s.a=i[o]}return}function w(e,t,n,r,i,s,o,u,a){var f=new Object,l=3;f.b=f.a=0;b(t,o,u,s,a,f);i.c=f.a;i.d=f.b;if(Math.abs(i.c)<=100*e*Math.abs(s[t-1])){if(Math.abs(i.d)<=100*e*Math.abs(s[t-2]))return l}i.h=u*r;if(Math.abs(i.d)>=Math.abs(i.c)){l=2;i.e=n/i.d;i.f=i.c/i.d;i.g=o*r;i.a3=i.e*(i.g+n)+i.h*(r/i.d);i.a1=-n+i.f*r;i.a7=i.h+(i.f+o)*n}else{l=1;i.e=n/i.c;i.f=i.d/i.c;i.g=i.e*o;i.a3=i.e*n+(i.g+i.h/i.c)*r;i.a1=-(n*(i.d/i.c))+r;i.a7=i.g*i.d+i.h*i.f+n}return l}function E(e,t,n,r,i,s,o,u,a){var f;if(n==3){o[1]=o[0]=0;for(var l=2;l<t;l++){o[l]=u[l-2]}return}f=n==1?i:r;if(Math.abs(s.a1)>10*e*Math.abs(f)){s.a7/=s.a1;s.a3/=s.a1;o[0]=a[0];o[1]=-(a[0]*s.a7)+a[1];for(var l=2;l<t;l++)o[l]=-(a[l-1]*s.a7)+u[l-2]*s.a3+a[l]}else{o[0]=0;o[1]=-(a[0]*s.a7);for(var l=2;l<t;l++){o[l]=-(a[l-1]*s.a7)+u[l-2]*s.a3}}return}function x(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g,y,b,w,E,S,x,T,N;t.b=t.a=0;if(e!=3){if(e!=2){g=n+h*o+c*f;y=u+(h+p*f)*a}else{g=(n+l)*f+c;y=(f+h)*u+p*a}b=-(d[v-1]/m[v]);w=-(d[v-2]+b*m[v-1])/m[v];E=p*w*r;S=b*s;x=b*b*i;T=-(S+x)+E;N=-T+y+b*g;if(N!=0){t.a=-((h*(x+S)+p*(b*r+w*s))/N)+h;t.b=p*(1+T/N)}}return}function T(e,t,n,r){var i,s,o;r.sr=r.si=r.lr=r.li=0;if(e==0){r.sr=t!=0?-(n/t):r.sr;return}if(n==0){r.lr=-(t/e);return}i=t/2;if(Math.abs(i)<Math.abs(n)){o=n>=0?e:-e;o=-o+i*(i/Math.abs(n));s=Math.sqrt(Math.abs(o))*Math.sqrt(Math.abs(n))}else{o=-(e/i*(n/i))+1;s=Math.sqrt(Math.abs(o))*Math.abs(i)}if(o>=0){s=i>=0?-s:s;r.lr=(-i+s)/e;r.sr=r.lr!=0?n/r.lr/e:r.sr}else{r.lr=r.sr=-(i/e);r.si=Math.abs(s/e);r.li=-r.si}return}function N(e,t,n,r,i,s,o,u,a,f,l,c){var h=new Object,p,d,v,m,g,y,S,N,C,k,L,A=0,O,M=0;n.NZ=0;y=r;N=i;do{h.li=h.lr=h.si=h.sr=0;T(1,y,N,h);n.szr=h.sr;n.szi=h.si;n.lzr=h.lr;n.lzi=h.li;if(Math.abs(Math.abs(n.szr)-Math.abs(n.lzr))>.01*Math.abs(n.lzr))break;b(o,y,N,a,s,u);d=Math.abs(-(n.szr*u.b)+u.a)+Math.abs(n.szi*u.b);k=Math.sqrt(Math.abs(N));p=2*Math.abs(s[0]);g=-(n.szr*u.b);for(L=1;L<t;L++){p=p*k+Math.abs(s[L])}p=p*k+Math.abs(g+u.a);p=(9*p+2*Math.abs(g)-7*(Math.abs(u.a+g)+k*Math.abs(u.b)))*e;if(d<=20*p){n.NZ=2;break}A++;if(A>20)break;if(A>=2){if(m<=.01&&d>=v&&!M){m=m<e?Math.sqrt(e):Math.sqrt(m);y-=y*m;N+=N*m;b(o,y,N,a,s,u);for(L=0;L<5;L++){O=w(e,t,u.a,u.b,l,c,y,N,f);E(e,t,O,u.a,u.b,l,c,f,s)}M=1;A=0}}v=d;O=w(e,t,u.a,u.b,l,c,y,N,f);E(e,t,O,u.a,u.b,l,c,f,s);O=w(e,t,u.a,u.b,l,c,y,N,f);x(O,u,u.a,l.a1,l.a3,l.a7,u.b,l.c,l.d,l.f,l.g,l.h,y,N,c,t,a);S=u.a;C=u.b;if(C!=0){m=Math.abs((-N+C)/C);y=S;N=C}}while(C!=0);return}function C(e,t,n,r,i,s,o,u,a){var f,l,c,h,p,d,v,m,g,y,b,w=r-1;t.NZ=b=g=0;v=n.a;for(;;){d=i[0];o[0]=d;for(y=1;y<s;y++){o[y]=d=d*v+i[y]}c=Math.abs(d);h=Math.abs(v);f=.5*Math.abs(o[0]);for(y=1;y<s;y++){f=f*h+Math.abs(o[y])}if(c<=20*e*(2*f-c)){t.NZ=1;t.szr=v;t.szi=0;break}b++;if(b>10)break;if(b>=2){if(Math.abs(m)<=.001*Math.abs(-m+v)&&c>p){g=1;t.a=v;break}}p=c;a[0]=l=u[0];for(y=1;y<r;y++){a[y]=l=l*v+u[y]}if(Math.abs(l)>Math.abs(u[w])*10*e){m=-(d/l);u[0]=o[0];for(y=1;y<r;y++){u[y]=m*a[y-1]+o[y]}}else{u[0]=0;for(y=1;y<r;y++)u[y]=a[y-1]}l=u[0];for(y=1;y<r;y++){l=l*v+u[y]}m=Math.abs(l)>Math.abs(u[w])*10*e?-(d/l):0;v+=m}return g}function k(e,t,n,r,i,s,o,u,a,f,l,c){var h=new Object,p=new Object,d=new Array(t),v=new Array(t),m,g,y,S,T,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R=1,U,z,W,X,V,$;c.NZ=0;S=y=.25;T=r;A=i;h.b=h.a=0;b(a,l,i,u,f,h);m=h.a;g=h.b;p.h=p.g=p.f=p.e=p.d=p.c=p.a7=p.a3=p.a1=0;X=w(e,o,m,g,p,s,l,i,d);for(U=0;U<n;U++){I=1;E(e,o,X,m,g,p,s,d,f);X=w(e,o,m,g,p,s,l,i,d);x(X,h,m,p.a1,p.a3,p.a7,g,p.c,p.d,p.f,p.g,p.h,l,i,s,o,u);B=h.a;F=j=h.b;M=s[o-1]!=0?-(u[o]/s[o-1]):0;_=P=1;if(U!=0&&X!=3){P=F!=0?Math.abs((F-A)/F):P;_=M!=0?Math.abs((M-T)/M):_;H=P<L?P*L:1;D=_<k?_*k:1;V=H<S?1:0;z=D<y?1:0;if(z||V){for(q=0;q<o;q++){v[q]=s[q]}O=M;W=$=0;for(;;){if(I&&(I=0)==0&&z&&(!V||D<H)){}else{N(e,o,c,B,j,f,a,h,u,d,p,s);m=h.a;g=h.b;if(c.NZ>0)return;R=$=1;S*=.25;if(W||!z){R=0}else{for(q=0;q<o;q++)s[q]=v[q]}}if(R!=0){h.a=O;R=C(e,c,h,o,u,a,f,s,d);O=h.a;if(c.NZ>0)return;W=1;y*=.25;if(R!=0){B=-(O+O);j=O*O;continue}}for(q=0;q<o;q++)s[q]=v[q];if(!V||$)break}b(a,l,i,u,f,h);m=h.a;g=h.b;X=w(e,o,m,g,p,s,l,i,d)}}A=F;T=M;L=P;k=_}return}function L(e,t,n,r){var i=e.Degree,s=3.141592653589793/180,o=Math.LN2,u=e.Degree+1,a=new Array(u),f=new Array(u),l=new Array(u),c=new Array(u),h=new Object,p=new Object,d,v,m,g,y,b,w,E,S,x,N,C,L,A,O,M,_,D,P,H,B,j,F,I;C=1;do{v=C;C/=2;L=1+C}while(L>1);var q=Number.MIN_VALUE/v,R=Math.cos(94*s),U=Math.sin(94*s),z=Math.sqrt(.5),W=-z;p.NZ=P=0;p.szr=p.szi=p.lzr=p.lzi=0;while(t[i]==0){n[P]=r[P]=0;i--;P++}F=i+1;while(i>=1){if(i<=2){if(i<2){n[e.Degree-1]=-(t[1]/t[0]);r[e.Degree-1]=0}else{h.li=h.lr=h.si=h.sr=0;T(t[0],t[1],t[2],h);n[e.Degree-2]=h.sr;r[e.Degree-2]=h.si;n[e.Degree-1]=h.lr;r[e.Degree-1]=h.li}break}w=0;E=Number.MAX_VALUE;for(X=0;X<F;X++){x=Math.abs(t[X]);if(x>w)w=x;if(x!=0&&x<E)E=x}S=q/E;if(S<=1&&w>=10||S>1&&Number.MAX_VALUE/S>=w){S=S==0?Number.MIN_VALUE:S;B=Math.floor(Math.log(S)/o+.5);y=Math.pow(2,B);if(y!=1){for(X=0;X<F;X++)t[X]*=y}}for(var X=0;X<F;X++)f[X]=Math.abs(t[X]);f[i]=-f[i];j=i-1;x=Math.exp((Math.log(-f[i])-Math.log(f[0]))/i);if(f[j]!=0){N=-f[i]/f[j];x=N<x?N:x}N=x;do{x=N;N=.1*x;b=f[0];for(var X=1;X<F;X++){b=b*N+f[X]}}while(b>0);g=x;do{m=b=f[0];for(var X=1;X<i;X++){b=x*b+f[X];m=x*m+b}b=x*b+f[i];g=b/m;x-=g}while(Math.abs(g/x)>.005);d=x;for(var X=1;X<i;X++)a[X]=(i-X)*t[X]/i;a[0]=t[0];C=t[i];L=t[j];I=a[j]==0?1:0;for(H=0;H<5;H++){A=a[j];if(I){for(var X=0;X<j;X++){P=j-X;a[P]=a[P-1]}a[0]=0;I=a[j]==0?1:0}else{M=-C/A;for(var X=0;X<j;X++){P=j-X;a[P]=M*a[P-1]+t[P]}a[0]=t[0];I=Math.abs(a[j])<=Math.abs(L)*v*10?1:0}}for(var X=0;X<i;X++)c[X]=a[X];for(H=1;H<=20;H++){D=-(U*W)+R*z;W=U*z+R*W;z=D;O=d*z;_=-(2*O);k(v,u,20*H,O,d,a,i,t,F,l,_,p);if(p.NZ!=0){P=e.Degree-i;n[P]=p.szr;r[P]=p.szi;F=F-p.NZ;i=F-1;for(var X=0;X<F;X++)t[X]=l[X];if(p.NZ!=1){n[P+1]=p.lzr;r[P+1]=p.lzi}break}else{for(var X=0;X<i;X++){a[X]=c[X]}}}if(H>20){e.Degree-=i;break}}return}var i=100,s=n(t.symbols).sort().pop(),o=t.group===e.groups.PL?t.symbols:t.symbols[s],f=o.group,l=f===u?[o.power]:n(o.symbols),c=[],h=e.Utils.arrayMax(l);for(var p=1;p<=h;p++){var d=0;if(l.indexOf(p+"")!==-1){if(f===u){d=o.multiplier}else{d=o.symbols[p].multiplier}}c.unshift(d)}c.push(t.symbols["#"].multiplier);var v=c.slice(0);c.unshift(h);if(h>i){throw new Error("This utility accepts polynomials of degree up to "+i+". ")}var m=[],g={};g.Degree=h;for(p=0;p<h;p++){m.push(0)}var y=m.slice(0);L(g,v,y,m);var A=m.length;for(p=0;p<A;p++){var O=a(m[p],r+8),M=a(y[p],r);M=r-String(M).length>2?M:y[p];var _=O<0?"-":"";if(M===0){M=""}if(O===0){O=""}O=Math.abs(O)===1?_+"i":O?O+"*i":"";var D=M&&O?M+"+"+O:M+O;y[p]=D.replace(/\+\-/g,"-")}return y}r=r||7;var i=0;if(t instanceof o&&t.isPoly()){if(t.group===e.groups.S){return[0]}else if(t.group===e.groups.PL){var s=n(t.symbols),f=e.Utils.arrayMin(s),l=e.PARSER.parse(t.value+"^"+f);i=f;t=e.PARSER.divide(t,e.PARSER.parse(t.value+"^"+f))}var c=p();for(var h=0;h<i;h++)c.unshift(0);return c}else{throw new Error("Cannot calculate roots. Symbol must be a polynomial!")}},factor:function(r){var i=r,s=r.group,u=function(e){return e===d||e===v};if(u(s)){for(var a in r.symbols)r.symbols[a].distributeMultiplier();var h=l.GCD.apply(undefined,r.coeffs()),m=function(e){for(var t in e.symbols){var n=e.symbols[t];if(u(n.group)){m(n)}else{n.multiplier/=h}}};m(r);r.multiplier*=h;if(s===d){var g=n(r.symbols),y=e.Utils.arrayMin(g),b=t.parse(r.value+"^"+y);var w=new e.Symbol(0);for(var a in r.symbols){w=t.add(w,t.divide(r.symbols[a],b.copy()))}w=t.symfunction(e.PARENTHESIS,[w]);w.power*=r.power;w.multiplier*=r.multiplier;b.power*=r.power;i=t.multiply(b,w)}else if(s===v){try{var E=e.Utils.arrayUnique(e.Algebra.proots(r)),S=true;for(var x=0;x<E.length;x++){if(!f(E[x]))S=false}var T=new o(1);if(S){E.map(function(n){T=t.multiply(T,t.symfunction(e.PARENTHESIS,[t.subtract(new o(c(r)[0]),new o(n))]))});T.multiplier*=r.multiplier;i=T}}catch(N){try{var C=r.collectSymbols(),k=r.length,L={};for(var x=0;x<k;x++){var A=C[x],O=vars.length;for(var M=0;M<O;M++){var D=vars[M],P=A.value===D?A:A.symbols[D],H=L[D];if(p(P.power))throw new Error("Cannot factor symbol. Exiting");if(!H)L[D]=[1,P.power];else{H[0]++;var B=P.power;if(B<H[1])H[1]=B}}}var b=[];for(var a in L){H=L[a];if(H[0]===k){b.push(a+"^"+H[1])}}b=t.parse(b.join("*"));for(a in r.symbols){r.symbols[a]=t.divide(r.symbols[a],b.copy())}i=t.multiply(t.parse(r.text()),b)}catch(N){}}}}if(i.group===e.groups.FN)i.updateHash();return i},expand:function(n){function i(e){if(!h(e))return e;var t=e.power,n=Math.abs(t);if(f(t)&&n!==1){var r=t/n,i=e.multiplier;n--;e.power=1;e.multiplier=1;var o=e.copy();for(var u=0;u<n;u++){o=s(o,u===n?e:e.copy())}o.multiplier=i;if(o.power)o.power*=r;e=o}return e}function s(n,r){var i=new o(0),u=h(n),a=h(r);if(!u&&a||n.power<0&&!(r.power<0)){var f=r;r=n;n=f;f=a;a=u;u=f}var i=new o(0),l=e.Utils.sameSign(n.power,r.power);if(u){for(var c in n.symbols){var p=n.symbols[c];if(a&&l){for(var d in r.symbols){var v=r.symbols[d],m;if(h(p)||h(v)){m=s(p.copy(),v.copy())}else{m=t.multiply(p.copy(),v.copy())}i=t.add(i,m)}}else{i=t.add(i,t.multiply(p.copy(),r.copy()))}}}else{i=t.multiply(n,r)}return i}var r=h(n);n=i(n);if(n.symbols&&n.group!==e.groups.EX){var u=n.collectSymbols(),a=u.length;for(var l=0;l<a-1;l++){var c=i(u.pop()),p=i(u.pop());var d=!r?s(c,p):t.add(c,p.copy());u.push(d)}var v=u[0];if(v){v.multiplier*=n.multiplier;if(v.group!==e.groups.N){v.distributeMultiplier();d.power*=n.power}n=v}}else if(n.args){n.args[0]=m.expand(n.args[0]);if(n.group===e.groups.FN)n.updateHash()}else if(n.group===e.groups.EX){n.power=m.expand(n.power)}return n},poly2Arrays:function(t,n){var r=this;if(!t.isPoly())throw new Error("Polynomial Expected! Received "+e.Utils.text(t));var i=[];if(Math.abs(t.power)!==1)t=e.Algebra.expand(t);if(t.group===e.groups.N){i.push([t.multiplier,0])}else if(t.group===e.groups.S){i.push([t.multiplier,t.power])}else{for(var s in t.symbols){if(e.Utils.isSymbol(u))throw new Error("power cannot be a Symbol");var o=t.symbols[s],u=o.power;if(o.symbols){i.push.apply(i,r.poly2Arrays(o))}else{i.push([o.multiplier,u||0])}}}if(n){i=i.sort(function(e,t){return e[1]>t[1]})}return i},zeroPolynomial:function(e){return e[0]===0&&e[1]===0},polyArrayCopy:function(e){return e.map(function(e){return e.slice(0)})},polyfill:function(e){if(e[0][1]!==0)e.unshift([0,0]);var t=e.length-1,n=[],r;for(var i=0;i<t;i++){r=e.pop();n.push(r);var s=r[1],o=e[t-(i+1)][1],u=s-o-1;for(var a=0;a<u;a++){n.push([0,s-(a+1)])}}n.push(e[0]);return n},polyArrayDiv:function(e,t){var n=t[0][1],r=t[0][0],i=t.length,s=0,o=[];do{var u=e[s][1],a=e[s][0]/r,f=u-n;if(f<0)break;o.push([a,f]);for(var l=0;l<i;l++){var c=s+l,h=t[l];e[c][0]-=h[0]*a}s++}while(f>0);var p=[],d=e.length;for(l=0;l<d;l++){var v=e[l];if(v[0]!==0)p.push(v)}if(o[0]===undefined)o.push([0,0]);if(p[0]===undefined)p.push([0,0]);return[o,p]},polyArrayCoeffs:function(e,t){var n=[],r=e.length;for(var i=0;i<r;i++){var s=e[i][0];if(s!==0||t)n.push(s)}return n},polydiv:function(n,r){if(n.group===e.groups.CB){var i=n.collectSymbols(),s=i.length,o=e.Utils.variables(n)[0],u,a;for(var f=0;f<s;f++){if(i[f].power<0){a=e.Utils.remove(i,f);break}}try{if(s-->2){for(f=0;f<s;f++){i[f]="("+i[f].text()+")"}u=t.parse(i.join("*"))}else{u=i[0]}var l;if(a.group===e.groups.S&&a.value===o){l=[[n.multiplier,n.power]]}else{l=e.Algebra.poly2Arrays(a,true)}var c=e.Algebra.poly2Arrays(u,true);c=e.Algebra.polyfill(c);l=e.Algebra.polyfill(l);var h=e.Algebra.polyArrayDiv(c,l),p=h[0],d=h[1];if(!r){var v=function(e){return e.map(function(e){return e[0]+"*"+o+"^"+e[1]}).join("+")};d=t.parse(v(d));p=t.parse(v(p))}return[p,d]}catch(m){}}return n},polyArrayGCD:function(t,n){var r=t[0][1],s=n[0][1];if(r===s&&t.length===1&&n.length===1){return[[e.Math2.GCD(t[0][0],n[0][0]),r]]}var o=e.Math2.GCD.apply(undefined,m.polyArrayCoeffs(t).concat(m.polyArrayCoeffs(n)));if(o!==1){var u=function(e){e[0]=e[0]/o;return e};t=t.map(u);n=n.map(u)}if(s>r){var a=n;n=t;t=a}var f=t,l=n,c,h;do{h=m.polyArrayDiv(m.polyArrayCopy(f),m.polyArrayCopy(l));c=h[1];f=l;l=c}while(!(c[0][0]===0&&c[0][1]===0));var p=f,d=p.length;var v=e.Math2.GCD.apply(undefined,m.polyArrayCoeffs(p))/o;if(v!==1){for(i=0;i<d;i++){p[i][0]/=v}}return p},polyGCD:function(){var t=e.Algebra.polyArrayGCD,n=arguments.length,r=0,i=m.poly2Arrays(arguments[r]);while(n>++r){var s=m.poly2Arrays(arguments[r]);i=t(m.polyfill(i),s=m.polyfill(s))}return i}};nerdamer.register([{name:"proots",visible:true,numargs:[1,2],build:function(){return m.proots}},{name:"factor",visible:true,numargs:1,build:function(){return m.factor}},{name:"expand",visible:true,numargs:1,warnings:"unoptimized, slow",build:function(){return m.expand}},{name:"polyGCD",visible:true,numargs:-1,build:function(){return m.polyGCD}}])})();(function(){var e=nerdamer.getCore(),t=e.PARSER,n=e.Utils.isSymbol,r=e.groups.FN,i=e.Symbol,s=e.Utils.text,o=e.Utils.inBrackets,u=e.groups.N,a=e.groups.S,r=e.groups.FN,f=e.groups.PL,l=e.groups.CP,c=e.groups.CB,h=e.groups.EX;var p=e.Calculus={version:"1.0.0",sum:function(n,r,o,u){if(!(r.group===e.groups.S))throw new Error("Index must be symbol. "+s(r)+" provided");r=r.value;var a;if(e.Utils.isNumericSymbol(o)&&e.Utils.isNumericSymbol(u)){o=o.multiplier;u=u.multiplier;var f=e.Utils.variables(n);if(f.length===1&&r===f[0]){var l=e.Utils.build(n);a=0;for(var c=o;c<=u;c++){a+=l.call(undefined,c)}}else{var l=n.text(),h={"~":true},a=new e.Symbol(0);for(var c=o;c<=u;c++){h[r]=new i(c);a=t.add(a,t.parse(l,h))}}}else{a=t.symfunction("sum",arguments)}return a},diff:function(d,v){function b(e){if(e.value===m||e.contains(m,true)){e.multiplier*=e.power;e.power-=1;if(e.power===0){e=i(e.multiplier)}}return e}function w(e){var d=e.group,v,g,y,T;if(d===u||d===a&&e.value!==m){e=i(0)}else if(d===a){e=b(e)}else if(d===c){var C=e.multiplier;e.multiplier=1;var k=t.multiply(x(e),b(e.copy()));k.multiplier*=C;return k}else if(d===r&&e.power===1){switch(e.baseName){case"log":T=e.copy();e=e.args[0].copy();if(n(e.power)){e.power=t.multiply(e.power,i(-1))}else{e.power*=-1}e.multiplier=T.multiplier/e.multiplier;break;case"cos":e.baseName="sin";e.multiplier*=-1;break;case"sin":e.baseName="cos";break;case"tan":e.baseName="sec";e.power=2;break;case"sec":e=E(e,"tan");break;case"csc":e=E(e,"-cot");break;case"cot":e.baseName="csc";e.multiplier*=-1;e.power=2;break;case"asin":e=t.parse("(sqrt(1-("+s(e.args[0])+")^2))^(-1)");break;case"acos":e=t.parse("-(sqrt(1-("+s(e.args[0])+")^2))^(-1)");break;case"atan":e=t.parse("(1+("+s(e.args[0])+")^2)^(-1)");break;case"abs":C=e.multiplier;e.multiplier=1;y=e.args[0].copy();y.multiplier=1;e=t.parse(o(s(e.args[0]))+"/abs"+o(s(y)));e.multiplier=C;break;case"parens":e=i(1);break}}else if(d===h||d===r&&n(e.power)){var L;if(d===h){L=e.value}else if(d===r&&e.contains(m)){L=e.baseName+o(s(e.args[0]))}else{L=e.value+o(s(e.args[0]))}g=t.multiply(t.parse("log"+o(L)),e.power.copy());y=p.diff(t.multiply(t.parse("log"+o(L)),e.power.copy()),m);e=t.multiply(e,y)}else if(d===r&&e.power!==1){y=e.copy();y.power=1;y.multiplier=1;e=t.multiply(b(e.copy(),m),w(y))}else if(d===l||d===f){var A=new i(0);for(var O in e.symbols){A=t.add(A,p.diff(e.symbols[O].copy(),m))}e=t.multiply(b(e.copy()),A)}e.updateHash();return e}function E(e,n,r){return t.multiply(e,t.parse(n+o(r||s(e.args[0]))))}function x(e){var n=e.collectSymbols(),r=new i(0),s=n.length;for(var o=0;o<s;o++){var u=p.diff(n[o].copy(),m);for(var a=0;a<s;a++){if(o!==a){u=t.multiply(u,n[a].copy())}}r=t.add(r,u)}return r}var m=n(v)?v.text():v;if(m===undefined)m=e.Utils.variables(d)[0];if(d.group===r&&!n(d.power)){var g=w(d);var y=p.diff(d.args[0].copy(),m);d=t.multiply(g,y)}else{d=w(d)}return d;}};nerdamer.register([{name:"diff",visible:true,numargs:[1,2],build:function(){return p.diff}},{name:"sum",visible:true,numargs:4,build:function(){return p.sum}}])})()
